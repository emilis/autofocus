<%

var {list, lists, tasks, log} = vars;

%><ul id="list-selector"><%

    for each (var tlist in lists) {
        print('<li');
        if (tlist.id == list.id) {
            print(' class="active"');
        }
        print('><a href="/?call=Autofocus.showList&id=', tlist.id, '">', tlist.title, '</a></li>');
    }

%>
</ul>
<div id="list">
    <div id="tasks">
        <h2>Tasks</h2>
        <table id="task-table"><tbody><%

            var action_td = '<td class="actions"><a class="done">D</a><a class="later">L</a><a class="remove">R</a></td>';

            for each (var task in tasks) {
                print('<tr id="task-', task.id, '"><td>', task.title, '</td>');
                print(action_td);
                print('</tr>');
            }

        %></tbody>
        <tfoot>
            <tr id="add-task">
                <td colspan="2">
                    <form onsubmit="autofocus.add(); return false;">
                        <small>Add new task:</small><br>
                        <input id="task-title" name="task-title"><br>
                        <input type="hidden" id="list-id" name="list-id" value="<%= list.id %>">
                    </form>
                </td>
            </tr>
        </tfoot></table>
    </div>
    <div id="log">
        <h2>Log</h2>
        <table id="log-table"><tbody><%

            for each (var entry in log) {
                print('<tr>');
                print('<td class="time">', entry.time.getHours(), ':', entry.time.getMinutes(), '</td>');
                print('<td class="', entry.action, '">', entry.action, '</td>');
                print('<td>', entry.details, '</td>');
                print('</tr>');
            }

        %>
        </tbody></table>
    </div>
</div>

